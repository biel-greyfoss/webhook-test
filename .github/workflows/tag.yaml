name:  Taging Pipeline
on:
  pull_request_review:
    types: 
      - submitted
jobs:
  Add_tag:
     runs-on: ubuntu-latest
     steps:     
       - name: Dump GitHub context
         env:
           PULL_REQUEST_BODY: ${{ github.event.pull_request.body }}
         run: echo "$PULL_REQUEST_BODY"
       - name: Extract Version
         id: image
         run:
          # Strip git ref prefix from version
          # $(echo "$COMMIT_MSG" | sed "s/.*release-\([^ ]*\).*$/\1/")
          VERSION=release-$(echo "$PULL_REQUEST_BODY" | sed -e 's,.*/\(.*\),\1,')
          echo VERSION=$VERSION
       - name: YAML Update Actoin
         uses: fjogeleit/yaml-update-action@master
         with:
           valueFile: 'deployment/deployment.yaml'
           propertyPath: 'spec.template.spec.containers.image'
           value: ${{ steps.image.outputs.version }}
       #- name: Tag test
       #  uses: EndBug/add-and-commit@v7
      

